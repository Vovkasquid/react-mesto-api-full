(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{19:function(e,t,n){},37:function(e,t,n){"use strict";n.r(t);var a=n(1),o=n.n(a),c=n(21),i=n.n(c),r=n(9),s=(n(19),n(25)),l=n(3),u=n(0);var d=function(e){var t=e.name,n=e.title,a=e.isOpen,o=e.onClose,c=e.children,i=e.buttonText,r=e.onSubmit;return Object(u.jsx)("div",{className:"".concat(a&&"popup_status_active"," popup edit-form edit-form_type_").concat(t),children:Object(u.jsxs)("form",{name:t+"EditForm",className:"edit-form__form-container",onSubmit:r,children:[Object(u.jsx)("h2",{className:"edit-form__form-description",children:n}),c,Object(u.jsx)("button",{"aria-label":i,type:"submit",className:"edit-form__submit-button edit-form__submit-button_type_".concat(t),children:i}),Object(u.jsx)("button",{"aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",type:"button",className:"popup__close-btn edit-form__close-button edit-form__close-button_type_".concat(t),onClick:o})]})})};var p=function(e){var t=e.card,n=e.onClose;return Object(u.jsx)("div",{className:"popup image-popup ".concat(t&&"popup_status_active"),children:Object(u.jsxs)("div",{className:"image-popup__container",children:[Object(u.jsx)("img",{src:null===t||void 0===t?void 0:t.link,alt:null===t||void 0===t?void 0:t.name,className:"image-popup__picture"}),Object(u.jsx)("p",{className:"image-popup__description",children:null===t||void 0===t?void 0:t.name}),Object(u.jsx)("button",{"aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",type:"button",className:"popup__close-btn image-popup__close-button",onClick:n})]})})},j=o.a.createContext();var h=function(e){var t=e.isOpen,n=e.onClose,a=e.onUpdateUser,c=o.a.useState(""),i=Object(l.a)(c,2),r=i[0],s=i[1],p=o.a.useState(""),h=Object(l.a)(p,2),m=h[0],b=h[1],f=o.a.useContext(j);o.a.useEffect((function(){s(f.name),b(f.about)}),[f,t]);var _=Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("input",{type:"text",name:"editProfileName",id:"name-input",className:"edit-form__info-input edit-form__info-input_type_name",placeholder:"\u0418\u043c\u044f",required:!0,minLength:"2",maxLength:"40",value:r||"",onChange:function(e){s(e.target.value)}}),Object(u.jsx)("span",{className:"edit-form__error-text name-input-error"}),Object(u.jsx)("input",{type:"text",name:"editProfileDescription",id:"description-input",className:"edit-form__info-input edit-form__info-input_type_description",placeholder:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",required:!0,minLength:"2",maxLength:"200",value:m||"",onChange:function(e){b(e.target.value)}}),Object(u.jsx)("span",{className:"edit-form__error-text description-input-error"})]});return Object(u.jsx)(d,{name:"profile",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",isOpen:t,onClose:n,buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",onSubmit:function(e){e.preventDefault(),a(r,m)},children:_})};var m=function(e){var t=e.isOpen,n=e.onClose,a=e.onUpdateAvatar,c=o.a.createRef(),i=Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("input",{type:"url",ref:c,name:"editLinkAvatar",id:"url-input-avatar",className:"edit-form__info-input edit-form__info-input_type_link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0430\u0432\u0430\u0442\u0430\u0440",required:!0}),Object(u.jsx)("span",{className:"edit-form__error-text url-input-avatar-error"})]});return Object(u.jsx)(d,{name:"avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",isOpen:t,onClose:function(){c.current.value="",n()},buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",onSubmit:function(e){e.preventDefault(),a(c.current.value),c.current.value=""},children:i})};var b=function(e){var t=e.isOpen,n=e.onClose,a=e.onAddPlace,c=o.a.useState(""),i=Object(l.a)(c,2),r=i[0],s=i[1],p=o.a.useState(""),j=Object(l.a)(p,2),h=j[0],m=j[1],b=Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("input",{type:"text",name:"editPlaceName",id:"place-input",className:"edit-form__info-input edit-form__info-input_type_place",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",required:!0,minLength:"2",maxLength:"30",value:r||"",onChange:function(e){s(e.target.value)}}),Object(u.jsx)("span",{className:"edit-form__error-text place-input-error"}),Object(u.jsx)("input",{type:"url",name:"editLinkPlace",id:"url-input",className:"edit-form__info-input edit-form__info-input_type_link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0,value:h||"",onChange:function(e){m(e.target.value)}}),Object(u.jsx)("span",{className:"edit-form__error-text url-input-error"})]});return Object(u.jsx)(d,{name:"place",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",isOpen:t,onClose:function(){s(""),m(""),n()},buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",onSubmit:function(e){e.preventDefault(),a(r,h),s(""),m("")},children:b})},f=n(2),_=n(22),O=n(23),g=new(function(){function e(t){var n=t.baseUrl,a=t.headers;Object(_.a)(this,e),this._baseUrl=n,this._headers=a}return Object(O.a)(e,[{key:"_checkResponse",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}},{key:"getUserInformation",value:function(){return fetch("".concat(this._baseUrl,"/users/me"),{method:"GET",headers:{authorization:"Bearer ".concat(localStorage.getItem("jwt")),"Content-Type":"application/json"}}).then(this._checkResponse)}},{key:"getInitialCards",value:function(){return fetch("".concat(this._baseUrl,"/cards"),{method:"GET",headers:{authorization:"Bearer ".concat(localStorage.getItem("jwt")),"Content-Type":"application/json"}}).then(this._checkResponse)}},{key:"editProfile",value:function(e,t){return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:{authorization:"Bearer ".concat(localStorage.getItem("jwt")),"Content-Type":"application/json"},body:JSON.stringify({name:e,about:t})}).then(this._checkResponse)}},{key:"editAvatar",value:function(e){return fetch("".concat(this._baseUrl,"/users/me/avatar "),{method:"PATCH",headers:{authorization:"Bearer ".concat(localStorage.getItem("jwt")),"Content-Type":"application/json"},body:JSON.stringify({avatar:e})}).then(this._checkResponse)}},{key:"addCard",value:function(e,t){return fetch("".concat(this._baseUrl,"/cards "),{method:"POST",headers:{authorization:"Bearer ".concat(localStorage.getItem("jwt")),"Content-Type":"application/json"},body:JSON.stringify({name:e,link:t})}).then(this._checkResponse)}},{key:"removeCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:{authorization:"Bearer ".concat(localStorage.getItem("jwt")),"Content-Type":"application/json"}}).then(this._checkResponse)}},{key:"addLike",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e,"/likes"),{method:"PUT",headers:{authorization:"Bearer ".concat(localStorage.getItem("jwt")),"Content-Type":"application/json"}}).then(this._checkResponse)}},{key:"removeLike",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e,"/likes"),{method:"DELETE",headers:{authorization:"Bearer ".concat(localStorage.getItem("jwt")),"Content-Type":"application/json"}}).then(this._checkResponse)}},{key:"changeLikeCardStatus",value:function(e,t){return t?this.addLike(e):this.removeLike(e)}}]),e}())({baseUrl:"https://api.mestosquid.nomoredomains.club"}),x=n(12),v=n(26),C=["component"],k=function(e){var t=e.component,n=Object(v.a)(e,C);return Object(u.jsx)(f.b,{children:function(){return!0===n.loggedIn?Object(u.jsx)(t,Object(x.a)({},n)):Object(u.jsx)(f.a,{to:"/sign-in"})}})};var N=function(e){var t=e.card,n=e.onCardClick,a=e.onCardLike,c=e.onCardDelete,i=o.a.useContext(j),r=i._id===t.owner,s=t.likes.some((function(e){return toString(e._id)===toString(i._id)}))?"card__like-button card__like-button_status_active":"card__like-button";return Object(u.jsxs)("li",{className:"card",children:[Object(u.jsx)("img",{src:t.link,alt:t.name,className:"card__photo",onClick:function(){return n(t)}}),Object(u.jsxs)("div",{className:"card__info",children:[Object(u.jsx)("h2",{className:"card__description",children:t.name}),Object(u.jsxs)("div",{className:"card__like-container",children:[Object(u.jsx)("button",{"aria-label":"\u041d\u0440\u0430\u0432\u0438\u0442\u0441\u044f",type:"button",className:s,onClick:function(){return a(t)}}),Object(u.jsx)("p",{className:"card__like-counter",children:t.likes.length})]})]}),r&&Object(u.jsx)("button",{"aria-label":"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u043c\u0435\u0441\u0442\u043e",type:"button",className:"card__delete-button",onClick:function(){return c(t)}})]})},y=n.p+"static/media/logo_mesto.bad0f45a.svg";var S=function(e){var t=e.loggedIn,n=e.textButton,a=e.userEmail,o=e.headerHandler;return Object(u.jsxs)("header",{className:"header page__header",children:[Object(u.jsx)("img",{src:y,alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f \u0441\u043e\u0446\u0441\u0435\u0442\u0438 \u041c\u0435\u0441\u0442\u043e",className:"logo"}),Object(u.jsxs)("div",{className:"header__info-block",children:[Object(u.jsx)("p",{className:"header__user-email",children:a||""}),Object(u.jsx)("button",{"aria-label":n,className:t?"header__universal-button header__universal-button_color_grey":"header__universal-button",onClick:o,children:n})]})]})};var T=function(){return Object(u.jsx)("footer",{className:"footer",children:Object(u.jsxs)("p",{className:"footer__copyright",children:["\xa9 ",(new Date).getFullYear()," Mesto Russia"]})})};var w=function(e){var t=e.onEditProfile,n=e.onAddPlace,a=e.onEditAvatar,c=e.onCardClick,i=e.cards,r=e.onCardLike,s=e.onCardDelete,l=e.headerHandler,d=e.email,p=o.a.useContext(j);return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(S,{loggedIn:!0,textButton:"\u0412\u044b\u0439\u0442\u0438",userEmail:d,headerHandler:l}),Object(u.jsxs)("main",{className:"content",children:[Object(u.jsxs)("section",{className:"profile",children:[Object(u.jsxs)("div",{className:"profile__person",children:[Object(u.jsx)("div",{className:"profile__avatar",style:{backgroundImage:"url(".concat(p.avatar,")")},children:Object(u.jsx)("div",{className:"profile__overlay",onClick:a})}),Object(u.jsxs)("div",{className:"profile__info",children:[Object(u.jsxs)("div",{className:"profile__name-container",children:[Object(u.jsx)("h1",{className:"profile__name",children:p.name}),Object(u.jsx)("button",{"aria-label":"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",type:"button",className:"profile__edit-button",onClick:t})]}),Object(u.jsx)("p",{className:"profile__description",children:p.about})]})]}),Object(u.jsx)("button",{"aria-label":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u043e\u0435 \u0444\u043e\u0442\u043e",type:"button",className:"profile__new-photo-button",onClick:n})]}),Object(u.jsx)("section",{className:"content-gallery",children:Object(u.jsx)("ul",{className:"content-gallery__cards",children:i.map((function(e){return Object(u.jsx)(N,{card:e,onCardClick:c,onCardLike:r,onCardDelete:s},e._id)}))})})]}),Object(u.jsx)(T,{})]})},L=n(14);var P=function(e){var t=e.isLogin,n=e.headerHandler,o=e.handlerSubmit,c=e.title,i=e.buttonTitle,r=e.children,s=Object(a.useState)({email:"",password:""}),d=Object(l.a)(s,2),p=d[0],j=d[1],h=function(e){var t=e.target,n=t.name,a=t.value;j(Object(x.a)(Object(x.a)({},p),{},Object(L.a)({},n,a)))};return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(S,{textButton:t?"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f":"\u0412\u043e\u0439\u0442\u0438",headerHandler:n}),Object(u.jsxs)("section",{className:"auth page__auth",children:[Object(u.jsx)("h1",{className:"auth__header",children:c}),Object(u.jsxs)("form",{onSubmit:function(e){e.preventDefault(),o(p.password,p.email)},name:"authorization",className:"auth__form",children:[Object(u.jsx)("input",{type:"email",name:"email",id:"email-input-login",className:"auth__input",placeholder:"Email",value:p.email,onChange:h,required:!0}),Object(u.jsx)("input",{type:"password",name:"password",id:"password-input-login",className:"auth__input",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",value:p.password,onChange:h,required:!0}),Object(u.jsx)("button",{"aria-label":i,type:"submit",className:"auth__button",children:i}),r]})]})]})};var I=function(e){var t=e.headerHandler,n=e.handlerLogin;return Object(u.jsx)(P,{isLogin:!0,headerHandler:t,handlerSubmit:n,title:"\u0412\u0445\u043e\u0434",buttonTitle:"\u0412\u043e\u0439\u0442\u0438"})};var E=function(e){var t=e.headerHandler,n=e.handlerRegister;return Object(u.jsx)(P,{isLogin:!1,headerHandler:t,handlerSubmit:n,title:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",buttonTitle:"\u0417\u0430\u0440\u0435\u0433\u0435\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f",children:Object(u.jsxs)("p",{className:"auth__answer-text",children:["\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b? ",Object(u.jsx)(r.b,{to:"/sign-in",className:"auth__link",children:"\u0412\u043e\u0439\u0442\u0438"})]})})},U=n.p+"static/media/auth-success.1b6082f8.svg",A=n.p+"static/media/auth-failed.df8eddf6.svg";var B=function(e){var t=e.isOpen,n=e.isSucces,a=e.onClose;return Object(u.jsx)("div",{className:t?"popup info-tool-tip-popup popup_status_active":"popup info-tool-tip-popup",children:Object(u.jsxs)("div",{className:"info-tool-tip-popup__container",children:[Object(u.jsx)("img",{src:n?U:A,alt:"\u041a\u0430\u0440\u0442\u0438\u043d\u043a\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u043e\u0439 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438",className:"info-tool-tip-popup__picture"}),Object(u.jsx)("p",{className:"info-tool-tip-popup__description",children:n?"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!":"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437."}),Object(u.jsx)("button",{"aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c",type:"button",className:"popup__close-btn info-tool-tip-popup__close-button",onClick:a})]})})},H="api.mestosquid.nomoredomains.club",D=function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430 ".concat(e.status))};var R=function(){var e=Object(f.g)(),t=o.a.useState(!1),n=Object(l.a)(t,2),a=n[0],c=n[1],i=o.a.useState(!1),r=Object(l.a)(i,2),_=r[0],O=r[1],x=o.a.useState(!1),v=Object(l.a)(x,2),C=v[0],N=v[1],y=o.a.useState(null),S=Object(l.a)(y,2),T=S[0],L=S[1],P=o.a.useState({}),U=Object(l.a)(P,2),A=U[0],R=U[1],F=o.a.useState([]),z=Object(l.a)(F,2),q=z[0],J=z[1],G=o.a.useState(!1),M=Object(l.a)(G,2),Y=M[0],K=M[1],Q=o.a.useState(""),V=Object(l.a)(Q,2),W=V[0],X=V[1],Z=o.a.useState(!1),$=Object(l.a)(Z,2),ee=$[0],te=$[1],ne=o.a.useState(!1),ae=Object(l.a)(ne,2),oe=ae[0],ce=ae[1];o.a.useEffect((function(){Promise.all([g.getUserInformation(),g.getInitialCards()]).then((function(e){var t=Object(l.a)(e,2),n=t[0],a=t[1];R(n.data),J(a.data.reverse())})).catch((function(e){console.log(e)}))}),[]),o.a.useEffect((function(){re()}),[]);var ie=function(){N(!1),c(!1),O(!1),te(!1),L(null)},re=function(){var t,n=localStorage.getItem("jwt");n&&(t=n,fetch("".concat(H,"/users/me"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)}}).then(D)).then((function(t){t.data.email&&(X(t.data.email),K(!0),e.push("/"))})).catch((function(e){console.log(e)}))};return Object(u.jsx)(j.Provider,{value:A,children:Object(u.jsx)("div",{className:"App",children:Object(u.jsxs)("div",{className:"page",children:[Object(u.jsxs)(f.d,{children:[Object(u.jsx)(f.b,{path:"/sign-up",children:Object(u.jsx)(E,{headerHandler:function(){e.push("/sign-in")},handlerRegister:function(t,n){(function(e,t){return fetch("".concat(H,"/signup"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({password:e,email:t})}).then(D)})(t,n).then((function(t){t.data.email&&(ce(!0),te(!0)),e.push("/sign-in")})).catch((function(e){console.log(e),ce(!1),te(!0)}))}})}),Object(u.jsx)(f.b,{path:"/sign-in",children:Object(u.jsx)(I,{headerHandler:function(){e.push("/sign-up")},handlerLogin:function(t,n){(function(e,t){return fetch("".concat(H,"/signin"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({password:e,email:t})}).then(D)})(t,n).then((function(t){console.log("data \u0432 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438 =",t),t.token&&(localStorage.setItem("jwt",t.token),console.log("token \u0432 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435=",localStorage.getItem("jwt")),K(!0),X(n),e.push("/"))})).catch((function(e){return console.log(e)}))}})}),Object(u.jsx)(k,{exact:!0,path:"/",loggedIn:Y,component:w,onAddPlace:function(){O(!0)},onEditAvatar:function(){N(!0)},onEditProfile:function(){c(!0)},cards:q,onCardClick:function(e){L(e)},onCardLike:function(e){var t=e.likes.some((function(e){return toString(e._id)===toString(A._id)}));g.changeLikeCardStatus(e._id,!t).then((function(t){J((function(n){return n.map((function(n){return n._id===e._id?t.data:n}))}))})).catch((function(e){return console.log(e)}))},onCardDelete:function(e){g.removeCard(e._id).then((function(){J((function(t){return t.filter((function(t){return t._id!==e._id}))}))})).catch((function(e){return console.log(e)}))},headerHandler:function(){localStorage.removeItem("jwt"),K(!1),e.push("/sign-in")},email:W}),Object(u.jsx)(f.b,{path:"*",children:Object(u.jsx)(f.a,{to:"/"})})]}),Object(u.jsx)(h,{isOpen:a,onClose:ie,onUpdateUser:function(e,t){g.editProfile(e,t).then((function(e){R(e.data),ie()})).catch((function(e){console.log(e)}))}}),Object(u.jsx)(m,{isOpen:C,onClose:ie,onUpdateAvatar:function(e){g.editAvatar(e).then((function(e){R(e.data),ie()})).catch((function(e){console.log(e)}))}}),Object(u.jsx)(b,{isOpen:_,onClose:ie,onAddPlace:function(e,t){g.addCard(e,t).then((function(e){J([e.data].concat(Object(s.a)(q))),ie()})).catch((function(e){console.log(e)}))}}),Object(u.jsx)(d,{name:"delete",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",onClose:ie,buttonText:"\u0414\u0430"}),Object(u.jsx)(p,{card:T,onClose:ie}),Object(u.jsx)(B,{isOpen:ee,onClose:ie,isSucces:oe})]})})})},F=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,38)).then((function(t){var n=t.getCLS,a=t.getFID,o=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),a(e),o(e),c(e),i(e)}))};i.a.render(Object(u.jsx)(o.a.StrictMode,{children:Object(u.jsx)(r.a,{children:Object(u.jsx)(R,{})})}),document.getElementById("root")),F()}},[[37,1,2]]]);
//# sourceMappingURL=main.8cbdc697.chunk.js.map